#!/bin/bash

_args=()

# Remap absolute paths to /host in the container
while [[ $# -gt 0 ]]; do
	_arg=$1
	if [[ $_arg =~ ^/ ]]; then
		_arg="/host${_arg}"
	fi
	_args+=( $_arg )
	shift
done

# Run cardano-cli via Docker
# We map the host filesystem and node socket into the container
docker run \
	-ti \
	--rm \
	-u $(id -u):$(id -g) \
	-v {{ .Paths.ContextDir }}/node-ipc:/ipc \
	-v /:/host \
	-w /host$(pwd) \
	ghcr.io/blinklabs-io/cardano-node:{{ .Package.Version }} \
	cli "${_args[@]}"
